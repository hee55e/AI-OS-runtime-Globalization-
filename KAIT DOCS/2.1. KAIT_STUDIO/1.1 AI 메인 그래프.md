# AI 메인 그래프

> 코드 동기 기준: 2026-02-03
> 원칙: 문서보다 코드가 우선입니다.

## 현재 구현
- 메인 그래프는 AI Instance 단위로 1개 `cognitive_pipeline` JSON에 저장됩니다.
- 실행 시 스키마 정규화 + 파이프라인 검증을 거친 clean graph가 사용됩니다.
- Conditional/Parallel/Await/Cyclic 등 제어 엣지는 실행 컨텍스트(run_cache) 기반으로 라우팅됩니다.
- 조건부 `matches`는 정규식 `re.match` 기준이라 패턴 설계에 주의해야 합니다.

## 프론트엔드 연결
- AI 선택 시 그래프 로드: Sidebar + Store 동기화
- 엣지 타입 메타는 `/api/v1/graph/edge-types`로 동적 로드됩니다.

## 백엔드 연결
- 그래프 메타 라우터: `kait_os/routers/execution/graph.py`
- 오케스트레이터: `kait_os/core/orchestration/pipeline_orchestrator.py`
- 조건 평가기: `kait_os/core/orchestration/graph/edges/condition_evaluator.py`
- LLM 노드 입력 처리: `kait_os/core/orchestration/graph/nodes/llm/llm_node.py`

## TODO
- [ ] 조건식 builder에서 `contains/matches` 차이와 예제를 UI에 명시
- [ ] 멀티모달 raw input이 텍스트로 비대화되는 케이스를 사전 감지/경고
- [ ] 메인 그래프 버전 관리(저장 이력/롤백) UI 제공

## 관련 코드
- `kait_os/routers/execution/graph.py`
- `kait_os/core/orchestration/pipeline_orchestrator.py`
- `kait_os/core/orchestration/graph/edges/condition_evaluator.py`
- `kait_os/core/orchestration/graph/nodes/llm/llm_node.py`
